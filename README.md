# PlayerSize Plugin

Плагин для Minecraft сервера на Spigot 1.21.10, который изменяет размер всех игроков, делая их гномами.

## Описание

Этот плагин автоматически устанавливает размер игроков, делая их гномами. По умолчанию игроки получают рост примерно ~1.5 блока (настраивается в конфиге). Размер назначается один раз при первом входе игрока и сохраняется навсегда. Для реализма каждый гном может иметь немного отличающийся рост.
<img width="640" height="535" alt="image" src="https://github.com/user-attachments/assets/d20e1621-48b6-4b90-8bf1-f83447e201f1" />

## Возможности

- ✅ Автоматическое изменение размера игроков при входе
- ✅ Случайный размер в диапазоне от 0.75 до 0.9 (рост ~1.35-1.62 блока, средний ~1.5 блока)
- ✅ Сохранение размера каждого игрока (UUID + ник для удобства)
- ✅ Настройка через config.yml с подробными комментариями
- ✅ Применение размера после респавна
- ✅ Команды управления: `/playersize set`, `/playersize reset`, `/playersize check`, `/playersize list`
- ✅ Система прав доступа для разных команд
- ✅ Работа с оффлайн игроками
- ✅ Tab-автодополнение команд
- ✅ Автоматическое уменьшение здоровья для маленьких игроков (для баланса)
- ✅ **Зелье изменения роста** - крафтится в верстаке, случайно меняет рост игрока
- ✅ **Применение зелья на мобов** - можно применять зелье на мобов через ПКМ
- ✅ **Визуальные эффекты** - красивые частицы и звуки при изменении размера
- ✅ **Поддержка всех грибов** - в рецепте можно использовать любой гриб из Minecraft

## Установка

1. Соберите плагин с помощью Maven:

   ```bash
   mvn clean package
   ```

2. Скопируйте файл `target/PlayerSize-1.2.0.jar` в папку `plugins` вашего сервера

3. Перезапустите сервер

4. При первом запуске будет создан файл `config.yml` в папке плагина

## Конфигурация

Файл `config.yml` находится в папке `plugins/PlayerSize/`:

```yaml
sizes:
  # Минимальный размер игрока (scale)
  # 0.75 = ~1.35 блока высоты (низкий гном)
  min-size: 0.75

  # Максимальный размер игрока (scale)
  # 0.9 = ~1.62 блока высоты (высокий гном)
  max-size: 0.9

  # Фиксированный размер по умолчанию
  # 0.83 = ~1.5 блока высоты (средний рост гнома)
  default-size: 0.83

  # Использовать случайный размер для реализма
  # true = каждый игрок получит случайный размер (гномы будут отличаться по росту)
  # false = все игроки получат одинаковый размер (default-size)
  use-random-size: true

# Настройки здоровья для маленьких игроков
health:
  # Уменьшать здоровье маленьким игрокам (для баланса)
  reduce-health-for-small-players: true

  # Порог размера для уменьшения здоровья
  # Игроки с размером <= этого значения получат уменьшенное здоровье
  # 0.666 = рост ~1.20 блока (игрок пролезает в 1 блок нагнувшись)
  small-size-threshold: 0.666

  # Количество сердец, которое отнимается у маленьких игроков
  # 2 = отнять 2 сердца (4 HP), итого будет 8 сердец (16 HP) вместо 10 (20 HP)
  health-reduction: 2
```

### Параметры:

- **min-size** - Минимальный размер игрока (scale)

  - По умолчанию: `0.75` (~1.35 блока высоты)
  - Используется как нижняя граница для случайного размера
  - `1.0` = нормальный размер игрока (~1.8 блока высоты)
  - `0.75` = низкий гном (~1.35 блока высоты)

- **max-size** - Максимальный размер игрока (scale)

  - По умолчанию: `0.9` (~1.62 блока высоты)
  - Используется как верхняя граница для случайного размера
  - `0.9` = высокий гном (~1.62 блока высоты)

- **default-size** - Фиксированный размер, если `use-random-size = false`

  - По умолчанию: `0.83` (~1.5 блока высоты - средний рост гнома)
  - Используется когда вы хотите, чтобы все игроки имели одинаковый размер
  - Рекомендуемое значение для гномов: `0.83` (рост ~1.5 блока)

- **use-random-size** - Использовать случайный размер для реализма
  - `true` (по умолчанию) - каждый игрок получит случайный размер от min-size до max-size
    - Это создаст разнообразие: гномы будут немного отличаться по росту
    - Средний рост будет примерно ~1.5 блока
  - `false` - все игроки получат одинаковый размер (default-size)

### Настройки здоровья для маленьких игроков:

- **reduce-health-for-small-players** - Уменьшать здоровье маленьким игрокам (для баланса)

  - По умолчанию: `true`
  - Если включено, игроки с размером <= `small-size-threshold` получат уменьшенное здоровье
  - Это создает баланс: маленькие игроки могут пролезать в 1 блок, но имеют меньше здоровья

- **small-size-threshold** - Порог размера для уменьшения здоровья

  - По умолчанию: `0.666` (рост ~1.20 блока)
  - Игроки с размером <= этого значения получат уменьшенное здоровье
  - Рекомендуемое значение: `0.666` (игрок пролезает в 1 блок нагнувшись)

- **health-reduction** - Количество сердец, которое отнимается у маленьких игроков
  - По умолчанию: `2` (отнять 2 сердца = 4 HP)
  - Итоговое здоровье: 8 сердец (16 HP) вместо стандартных 10 (20 HP)
  - Можно настроить от 1 до 5 сердец

### Настройки зелья изменения роста:

```yaml
potion:
  # Включить/выключить зелье изменения роста
  enabled: true

  # Применять зелье на мобов через ПКМ
  apply-on-mobs: true

  # Рецепт крафта (9 слотов, порядок не важен)
  recipe:
    - NETHER_STAR
    - BROWN_MUSHROOM # Поддерживаются все грибы
    - POTION
    - ENDER_EYE
    - DRAGON_BREATH
    - PHANTOM_MEMBRANE
    - SPIDER_EYE
    - DIAMOND
    - ENCHANTED_GOLDEN_APPLE

  # Название и описание зелья
  name: "§6§lЗелье Изменения Роста"
  lore:
    - "§7Используйте это зелье, чтобы"
    - "§7случайно изменить свой рост!"

  # Цвет зелья (RGB)
  color:
    red: 255
    green: 165
    blue: 0
```

**Параметры зелья:**

- **enabled** - Включить/выключить зелье (по умолчанию: `true`)
- **apply-on-mobs** - Применять зелье на мобов через ПКМ (по умолчанию: `true`)
- **recipe** - Рецепт крафта зелья (можно настроить любой)
  - Поддерживаются все грибы: `BROWN_MUSHROOM`, `RED_MUSHROOM`, `CRIMSON_FUNGUS`, `WARPED_FUNGUS`
  - Порядок предметов в верстаке не важен
- **name** - Название зелья (с поддержкой цветов через `§`)
- **lore** - Описание зелья (несколько строк)
- **color** - Цвет зелья в RGB формате (0-255)

**Как использовать зелье:**

1. **Крафт:** Положите все ингредиенты в верстак (порядок не важен)
2. **На игроков:** Выпейте зелье - ваш рост случайно изменится
3. **На мобов:** Возьмите зелье в руку и кликните ПКМ по мобу
4. **В креативе:** Зелье не расходуется при применении на мобов

### Справка по размерам:

| Scale | Рост (блоки) | Описание                              |
| ----- | ------------ | ------------------------------------- |
| 5.0   | ~9.0         | Максимальный размер (лимит Minecraft) |
| 1.0   | ~1.8         | Нормальный игрок                      |
| 0.9   | ~1.62        | Высокий гном                          |
| 0.83  | ~1.5         | Средний гном ⭐ РЕКОМЕНДУЕТСЯ         |
| 0.75  | ~1.35        | Низкий гном                           |
| 0.666 | ~1.20        | Маленький гном (пролезает в 1 блок)   |
| 0.5   | ~0.9         | Очень маленький                       |

## Как это работает

1. При первом входе игрока на сервер плагин:

   - Генерирует случайный размер в диапазоне min-size..max-size (если use-random-size = true)
     - Это создаст разнообразие: гномы будут немного отличаться по росту
     - Средний рост будет примерно ~1.5 блока
   - Или устанавливает фиксированный размер default-size (если use-random-size = false)
     - Все гномы будут одного роста
   - Сохраняет размер в файл `player_sizes.json`

2. При каждом последующем входе:

   - Плагин загружает сохраненный размер игрока
   - Применяет его к игроку

3. Размер применяется также после респавна игрока

## Команды

Все команды можно использовать с алиасами: `/psize` или `/psz` вместо `/playersize`

### `/playersize reload`

Перезагружает конфигурацию плагина без перезапуска сервера.

**Права доступа:** `playersize.admin` (только админы/OP)

**Использование:**

```
/playersize reload
```

---

### `/playersize set <игрок> <размер>`

Устанавливает конкретный размер указанному игроку. Работает как с онлайн, так и с оффлайн игроками. При применении показываются визуальные эффекты (частицы и звуки).

**Права доступа:** `playersize.admin` (только админы/OP)

**Параметры:**

- `<игрок>` - ник игрока или UUID
- `<размер>` - размер от 0.1 до 5.0 (1.0 = нормальный размер, максимум в Minecraft = 5.0)

**Использование:**

```
/playersize set PlayerName 0.83
/playersize set PlayerName 1.0
```

**Примеры:**

- `/playersize set Notch 0.75` - установить размер 0.75 игроку Notch
- `/psize set PlayerName 1.0` - установить нормальный размер игроку
- `/playersize set PlayerName 5.0` - установить максимальный размер (5.0)

**Особенности:**

- При применении показываются визуальные эффекты (частицы и звуки)
- Размер сохраняется в базе данных
- Здоровье автоматически пересчитывается

---

### `/playersize reset <игрок|all>`

Сбрасывает размер игрока и генерирует новый (или устанавливает дефолтный, если `use-random-size = false`). Работает как с онлайн, так и с оффлайн игроками. При применении показываются визуальные эффекты.

**Права доступа:** `playersize.admin` (только админы/OP)

**Параметры:**

- `<игрок>` - ник игрока или UUID
- `all` - сбросить размер всем игрокам на сервере

**Использование:**

```
/playersize reset PlayerName
/playersize reset all
```

**Примеры:**

- `/playersize reset Notch` - сбросить размер игрока Notch
- `/psize reset PlayerName` - сбросить размер игроку
- `/playersize reset all` - сбросить размер всем игрокам на сервере
- `/psz reset all` - короткая версия для сброса всех

**Особенности:**

- При применении показываются визуальные эффекты (частицы и звуки)
- Размер сохраняется в базе данных
- Здоровье автоматически пересчитывается

---

### `/playersize check <игрок>`

Показывает текущий размер указанного игрока, включая рост в блоках.

**Права доступа:** `playersize.check` (по умолчанию доступно всем игрокам)

**Параметры:**

- `<игрок>` - ник игрока или UUID

**Использование:**

```
/playersize check PlayerName
```

**Примеры:**

- `/playersize check Notch` - проверить размер игрока Notch
- `/psize check PlayerName` - проверить размер игроку

**Вывод команды:**

```
[PlayerSize] Игрок: PlayerName
[PlayerSize] Рост: 1.49 блока
[PlayerSize] Размер: 0.83
```

---

### `/playersize list [страница]`

Показывает список всех игроков с их ростом в блоках. Список отсортирован от самого высокого к самому низкому. Поддерживает пагинацию (страницы).

**Права доступа:** `playersize.list` (по умолчанию доступно всем игрокам)

**Параметры:**

- `[страница]` - номер страницы (необязательно, по умолчанию 1)

**Использование:**

```
/playersize list
/playersize list 2
/playersize list 3
```

**Примеры:**

- `/playersize list` - показать первую страницу списка
- `/playersize list 2` - показать вторую страницу
- `/psize list` - короткая версия

**Вывод команды:**

```
========== [PlayerSize] Список игроков ==========
Страница 1 из 2 (Всего игроков: 25)

PlayerName - Рост: 1.62 блока
AnotherPlayer - Рост: 1.49 блока
ThirdPlayer - Рост: 1.35 блока
...

===============================================
Используйте /playersize list <номер> для перехода на другую страницу
```

**Особенности:**

- Список отсортирован от самого высокого игрока к самому низкому
- Показывает рост в блоках (не scale значение)
- По 15 игроков на страницу
- Автоматически вычисляет количество страниц

---

## Права доступа (Permissions)

Плагин использует систему прав для контроля доступа к командам:

- **`playersize.admin`** - Полный доступ ко всем командам (по умолчанию: только OP)

  - `/playersize reload`
  - `/playersize set`
  - `/playersize reset`

- **`playersize.check`** - Право на просмотр размеров игроков (по умолчанию: все игроки)

  - `/playersize check`

- **`playersize.list`** - Право на просмотр списка всех игроков (по умолчанию: все игроки)
  - `/playersize list`

**Пример настройки в плагине управления правами (например, LuckPerms):**

```
/lp group default permission set playersize.check true
/lp group default permission set playersize.list true
/lp group admin permission set playersize.admin true
```

## Зелье Изменения Роста

Плагин включает специальное зелье, которое можно скрафтить и использовать для случайного изменения роста.

### Крафт зелья

Зелье крафтится в верстаке из 9 предметов (порядок не важен):

- Звезда незера
- Гриб (любой: коричневый, красный, багровый, искаженный)
- Зелье слабости 2
- Око эндера
- Дыхание дракона
- Мембрана фантома
- Паучий глаз
- Алмаз
- Зачарованное золотое яблоко

**Важно:** Рецепт можно настроить в `config.yml`!

### Использование зелья

1. **На игроков:** Выпейте зелье - ваш рост случайно изменится
2. **На мобов:** Возьмите зелье в руку и кликните ПКМ по мобу
   - В креативном режиме зелье не расходуется
   - В других режимах зелье расходуется (убирается 1 штука)

### Визуальные эффекты

При изменении размера (через зелье или команду) показываются:

- Оранжевые частицы вокруг игрока/моба
- Вспышка сверху (сердечки)
- Звук повышения уровня

## Технические детали

- Использует атрибут `minecraft:scale` (доступен с версии 1.20.4+)
- Конфигурация в формате YAML с подробными комментариями
- Размеры игроков сохраняются в JSON формате (UUID + ник)
- Совместим с Spigot 1.21.10
- Модульная архитектура (разделение на классы для удобства)

## Требования

- Spigot 1.21.10 или выше
- Java 21

## Разработка

Для разработки используйте Maven:

```bash
mvn clean compile
mvn clean package
```

## История изменений

Подробная история изменений доступна в файле [CHANGELOG.md](CHANGELOG.md).

## Лицензия

Этот плагин создан для личного использования.
