# Changelog

Все значимые изменения в проекте PlayerSize будут документироваться в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
и этот проект придерживается [Semantic Versioning](https://semver.org/lang/ru/).

## [1.2.0] - 2024-11-28

### Добавлено

- **Зелье изменения роста** - новый предмет, который можно скрафтить в верстаке
  - Крафтится из 9 предметов (порядок не важен)
  - При использовании случайно меняет рост игрока
  - Настраиваемый рецепт в `config.yml`
  - Настраиваемое название, описание и цвет зелья
- **Применение зелья на мобов** - можно применять зелье на мобов через ПКМ
  - Настройка `potion.apply-on-mobs` в конфиге
  - В креативном режиме зелье не расходуется
  - В других режимах зелье расходуется при применении
- **Визуальные эффекты** при изменении размера
  - Оранжевые частицы вокруг игрока/моба
  - Вспышка сверху (сердечки)
  - Звук повышения уровня
  - Эффекты применяются при использовании зелья и команд `/playersize set`/`reset`
- **Поддержка всех грибов** в рецепте зелья
  - Автоматическое распознавание всех видов грибов (BROWN_MUSHROOM, RED_MUSHROOM, CRIMSON_FUNGUS, WARPED_FUNGUS)
  - Можно использовать любой гриб, если в рецепте указан любой из них
- **Настройка отладочных логов крафта** - новая опция в конфиге `potion.debug-crafting`
  - По умолчанию логи крафта выключены (`false`)
  - Можно включить для отладки проблем с крафтом (`true`)
  - Все логи крафта теперь контролируются через эту настройку
- **Команда `/playersize give potion`** - выдача зелий роста администратором
  - Формат: `/playersize give potion [игрок] <количество>`
  - Если игрок не указан, зелье выдается тому, кто выполняет команду
  - Поддержка выдачи от 1 до 64 зелий
  - Если инвентарь полон, зелья выкидываются на землю
  - Работает только если зелье включено в конфиге

### Изменено

- Рефакторинг кода - разделение на классы для удобства чтения и редактирования:
  - `ConfigManager` - управление конфигурацией
  - `PlayerSizeManager` - управление размерами игроков
  - `SizePotionManager` - управление зельем
  - `CraftManager` - управление крафтом зелья
- Улучшена структура проекта для дальнейшего развития

### Исправлено

- Исправлен формат YAML конфига (комментарии после значений в списках)
- Исправлена логика проверки рецепта крафта
- **Критический баг:** Исправлен дюп предметов при крафте зелья
  - Теперь предметы правильно удаляются из крафт-сетки после крафта
  - Если в верстаке было больше одного предмета каждого типа, они корректно уменьшаются на 1
  - Исправлена логика удаления предметов через `InventoryClickEvent` и правильную работу с индексами слотов
- Исправлена проблема с невозможностью крафтить несколько зелий подряд
  - После крафта зелья рецепт автоматически обновляется, если предметов хватает для следующего крафта
  - Теперь можно крафтить несколько зелий подряд без перестановки предметов
- Улучшена поддержка крафта в разных типах инвентарей
  - Для рецептов из 5+ предметов требуется верстак (WORKBENCH)
  - Для рецептов из 4 и меньше предметов можно использовать и инвентарь 2x2 (CRAFTING)

## [1.1.0] - 2024-11-28

### Добавлено

- Команда `/playersize list [страница]` - список всех игроков с их ростом
  - Сортировка от самого высокого к самому низкому
  - Отображение роста в блоках (не scale значение)
  - Пагинация (15 игроков на страницу)
  - Убрана информация об онлайн/оффлайн статусе
- Команда `/playersize check <игрок>` - проверка размера игрока
  - Изменен порядок вывода: Игрок → Рост → Размер
  - Работает с оффлайн игроками
- Команда `/playersize reset <игрок|all>` - сброс размера
  - Поддержка сброса всех игроков через `all`
- Сохранение ников игроков в `player_sizes.json` для удобства ручного редактирования
- Автоматическое уменьшение здоровья для маленьких игроков
  - Настройки в `config.yml`: `health-settings`
  - Игроки с размером <= 0.666 получают -2 сердца (8 сердец вместо 10)
  - Настраиваемый порог и количество отнимаемых сердец

### Изменено

- Конфигурация переведена из JSON в YAML формат (`config.yml`)
- Добавлены подробные комментарии для каждого параметра в конфиге
- Обновлены значения по умолчанию для роста ~1.5 блока
- Улучшена структура данных (UUID + ник)

## [1.0.0] - 2024-11-28

### Добавлено

- Автоматическое изменение размера игроков при входе
- Случайный размер в диапазоне (настраивается)
- Сохранение размеров игроков в `player_sizes.json`
- Команда `/playersize reload` - перезагрузка конфигурации
- Команда `/playersize set <игрок> <размер>` - установка размера
- Система прав доступа (permissions)
- Tab-автодополнение команд
- Применение размера после респавна
- Работа с оффлайн игроками
- Конфигурация через `config.json`

[1.2.0]: https://github.com/MrMe0ws/PlayerSize/compare/v1.1.0...v1.2.0
[1.1.0]: https://github.com/MrMe0ws/PlayerSize/compare/v1.0.0...v1.1.0
[1.0.0]: https://github.com/MrMe0ws/PlayerSize/releases/tag/v1.0.0
